<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.universal.persistence.mapper.SysOperLogMapper">

  <resultMap type="cn.universal.persistence.entity.SysOperLog" id="SysOperLogResult">
    <id property="operId" column="oper_id"/>
    <result property="title" column="title"/>
    <result property="businessType" column="business_type"/>
    <result property="method" column="method"/>
    <result property="requestMethod" column="request_method"/>
    <result property="operatorType" column="operator_type"/>
    <result property="operName" column="oper_name"/>
    <result property="deptName" column="dept_name"/>
    <result property="operUrl" column="oper_url"/>
    <result property="operIp" column="oper_ip"/>
    <result property="operLocation" column="oper_location"/>
    <result property="operParam" column="oper_param"/>
    <result property="jsonResult" column="json_result"/>
    <result property="status" column="status"/>
    <result property="errorMsg" column="error_msg"/>
    <result property="operTime" column="oper_time"/>
  </resultMap>

  <select id="selectList" parameterType="cn.universal.persistence.entity.SysOperLog"
    resultMap="SysOperLogResult">
    select * from sys_oper_log u
    <where>
      <if test="title!=null and title!=''">
        and u.title=#{title}
      </if>
      <if test="operName!=null and  operName!=''">
        and u.oper_name like concat('%',#{operName},'%')
      </if>
      <if test="businessType!=null  and businessType!=''">
        and u.business_type=#{businessType}
      </if>
      <if test="status !=null and status!=''">
        and u.status=#{status}
      </if>
      <if test="params!=null and params.beginTime!=null and params.beginTime!=''">
        and date_format(oper_time,'%y%m%d') >= date_format(#{params.beginTime},'%y%m%d')
      </if>
      <if test="params!=null and params.endTime!=null and params.endTime!=''">
        and date_format(oper_time,'%y%m%d') &lt;= date_format(#{params.endTime},'%y%m%d')
      </if>
      <!--      <if test="params!=null and params.scope != null and params.scope != ''">-->
      <!--        AND ( ${params.scope} )-->
      <!--      </if>-->
    </where>
    order by oper_time desc
  </select>
</mapper> 