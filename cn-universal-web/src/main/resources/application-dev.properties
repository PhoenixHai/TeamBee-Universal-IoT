# ================================
# 协议模块开关配置
# ================================
# TCP协议
tcp.protocol.enabled=true
# CT-AIoT协议 (电信)
ctaiot.protocol.enable=true
# OneNet协议 (移动)
onenet.protocol.enabled=true
# ImouLife协议 (乐橙)
imoulife.protocol.enabled=true
# ================================
# 其他开关配置
# ================================
# 日志分表是否开启
shard.logMeta.enable=true
# ================================
# 服务器配置
# ================================
server.port=9092
server.instance.id=
logging.file.path=../logs/cn-universal2/
# ================================
# System内置EMQX配置,集群也需要
# ================================
cn.universal.mqtt.desc=MQTT IoT 平台 broker 服务器配置
cn.universal.mqtt.enable=true
cn.universal.mqtt.host=tcp://127.0.0.1:1883
cn.universal.mqtt.clientIdPrefix=univ_iot_test
cn.universal.mqtt.client.username=
cn.universal.mqtt.client.password=
cn.universal.mqtt.subscribeTopics=univ_iot/#
cn.universal.mqtt.topicPrefix=
cn.universal.mqtt.keepAliveInterval=60
cn.universal.mqtt.cleanSession=true
cn.universal.mqtt.autoReconnect=true
cn.universal.mqtt.defaultQos=1
# ================================
# 数据库配置
# ================================
spring.datasource.type=com.alibaba.druid.pool.DruidDataSource
spring.datasource.druid.initial-size=8
spring.datasource.druid.max-wait=10000
spring.datasource.druid.max-active=8
spring.datasource.druid.min-evictable-idle-time-millis=300000
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.datasource.url=jdbc:mysql://192.168.31.194:3306/univ?useUnicode=true&characterEncoding=utf8&serverTimezone=GMT%2B8&useSSL=true&useJDBCCompliantTimezoneShift=true
spring.datasource.username=root
spring.datasource.password=
mybatis.mapper-locations=classpath*:mybatis/**/*.xml
# ================================
# Redis 配置
# ================================
spring.data.redis.database=12
spring.data.redis.host=192.168.31.194
spring.data.redis.port=
spring.data.redis.password=
spring.data.redis.timeout=30000
spring.data.redis.lettuce.pool.max-active=8
spring.data.redis.lettuce.pool.max-idle=8
spring.data.redis.lettuce.pool.min-idle=0
# ================================
# ClickHouse 数据库配置
# ================================
clickhouse.enable=false
clickhouse.address=jdbc:clickhouse://127.0.0.1:8123/univ
clickhouse.username=default
clickhouse.password=
clickhouse.db=
clickhouse.socketTimeout=6000
clickhouse.table.iot_device_log=iot_device_log
clickhouse.table.iot_device_log_metadata=iot_device_log_metadata
# ================================
# Spring 配置
# ================================
# 文件上传大小限制
spring.servlet.multipart.max-file-size=10MB
# ================================
# CTWing AEP 平台配置
# ================================
ct.aiot.aep.server=msgpush.ctwing.cn:16651
ct.aiot.aep.appid=
ct.aiot.aep.appkey=
ct.aiot.aep.appsecret=
ct.aiot.aep.tenantId=
ct.aiot.aep.token=
# ================================
# OneNET 平台配置
# ================================
ctaiot.protocol.broker=tcp://183.0.0.1:8883
ctaiot.protocol.userId=
ctaiot.protocol.accessKey=++mBfw==
ctaiot.protocol.projectId=
# ================================
# 大华平台配置
# ================================
imoulife.host=https://openapi.lechange.cn
imoulife.port=443
imoulife.ver=1.0
imoulife.appid=
imoulife.appsecret=
# ================================
# SNI_TCP 服务器配置
# ================================
sni.tcp.port=38880
# ================================
# 云存储配置
# ================================
cloud-storage.aliyun.endpoint=http://oss-cn-hangzhou.aliyuncs.com
cloud-storage.aliyun.prefix=
cloud-storage.aliyun.access-key-id=
cloud-storage.aliyun.access-key-secret=
cloud-storage.aliyun.bucket-name=
# ================================
# 设备注册配置
# ================================
iot.register.auto.unionId=auto_register
iot.register.auto.latitude=31.081598
iot.register.auto.longitude=81.314141
# ================================
# 设备日志分表配置
# ================================
# 日志分表是否开启
shard.log.enable=true
# 日志分表数量
shard.log.table.number=24
# 每个实际节点对应虚拟节点数量
shard.log.virtual.number=8
# ================================
# 日志事件表配置
# ================================
# 日志分表数量
shard.logMeta.table.number=24
# 每个实际节点对应虚拟节点数量
shard.logMeta.virtual.number=8
# 新旧设备分割时间戳
shard.device.split.timestamp=1672107427
# ================================
# WebSocket 配置
# ================================
# 禁用 WebSocket 以消除警告（如果不需要 WebSocket 功能）
#spring.websocket.enabled=false
# ================================
# 安全配置
# ================================
security.production.enabled=false
security.allowed.ips=
security.allowed.hosts=
security.actuator.enabled=true
security.access.monitor.enabled=false
# ================================
# 开发工具配置
# ================================
spring.devtools.restart.enabled=true
spring.devtools.livereload.enabled=true
# ================================
# Spring Boot 3.5 + JDK 21 优化配置
# ================================
# 虚拟线程配置
spring.threads.virtual.enabled=true
jdk.virtualThreadScheduler.parallelism=10
jdk.virtualThreadScheduler.maxPoolSize=100
# ================================
# 可观测性配置
# ================================
# Actuator 端点
management.endpoints.web.exposure.include=health,info,metrics,prometheus,env,configprops
management.endpoints.web.base-path=/actuator
management.endpoint.health.show-details=always
management.endpoint.health.show-components=always
# 虚拟线程监控
management.metrics.jvm.threads.virtual.enabled=true
management.metrics.jvm.threads.pools.enabled=true
# ================================
# 性能优化
# ================================
# HTTP/2 支持
server.http2.enabled=true
# 压缩配置
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json
server.compression.min-response-size=1024
# ================================
# 缓存配置
# ================================
# Caffeine 缓存
spring.cache.type=caffeine
spring.cache.cache-names=device-cache,user-cache,config-cache
spring.cache.caffeine.spec=maximumSize=1000,expireAfterWrite=300s
# 虚拟线程监控日志
logging.level.jdk.virtual=DEBUG
# 多级缓存配置
cache.multi-level.enabled=true
# L1 缓存配置（本地缓存 - Caffeine）
cache.multi-level.l1.enabled=true
cache.multi-level.l1.expire-after-write=300
cache.multi-level.l1.expire-after-access=300
cache.multi-level.l1.initial-capacity=100
cache.multi-level.l1.maximum-size=5000
# L2 缓存配置（分布式缓存 - Redis）
cache.multi-level.l2.enabled=true
cache.multi-level.l2.expire-after-write=3600
cache.multi-level.l2.key-prefix=mlc:
# 默认配置
cache.multi-level.defaults.strategy=WRITE_THROUGH
cache.multi-level.defaults.enable-multi-level=true
cache.multi-level.defaults.default-l1-expire=300
cache.multi-level.defaults.default-l2-expire=3600
# 支持的第三方平台生命周期
universal.iot.third.lifecycle.supported={"ctaiot":[]}